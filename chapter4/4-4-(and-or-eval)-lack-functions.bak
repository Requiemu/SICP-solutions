#lang racket

;;(define (true? exp) (...))

(define (tagged-list? exp tag)
  (if (pair? exp)
      (eq? (car exp) tag)
      false))

(define (first-clause clauses) (car clauses))
(define (rest-clauses clauses) (cdr clauses))

(define (and? exp) (tagged-list? exp 'and))
(define (and-clauses exp) (cdr exp))

(define (eval-and exp env)
  (define (iter clauses)
    (if (null? clauses) #t
        (if (true? (eval (first-clause clauses)))
            (iter (rest-clauses clauses))
            #f)))
  (if (null? exp) 
      (error "no argument in EVAL-AND" exp) 
      (iter (and-clauses exp))))

(define (false? exp) (not (true? exp)))

(define (or? exp) (tagged-list? exp 'or))
(define (or-clauses exp) (cdr exp))

(define (eval-or exp env)
  (define (iter clauses)
    (if (null? clauses) #f
        (if (false? (eval (first-clause clauses)))
            (iter (rest-clauses clauses))
            #t)))
  (if (null?exp)
      (error "no argument in EVAL-OR" exp)
      (iter (or-clauses exp))))
